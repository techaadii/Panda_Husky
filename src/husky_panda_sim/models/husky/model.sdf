<?xml version="1.0" ?>
<sdf version="1.8">

  <model name="husky">
    <pose>0 0 0.3 0 0 0</pose>

    <link name="base_link">
      <inertial>
        <mass>33.85</mass>
        <inertia>
          <ixx>2.2</ixx> <iyy>3.4</iyy> <izz>2.1</izz>
          <ixy>0</ixy> <ixz>0</ixz> <iyz>0</iyz>
        </inertia>
      </inertial>

      <collision name="base_collision">
        <pose>0 0 0.06 0 0 0</pose>
        <geometry>
          <box>
            <size>1.0 0.40 0.25</size>
          </box>
        </geometry>
      </collision>

      <visual name="base_visual">
        <geometry><mesh><uri>model://husky/meshes/base_link.stl</uri></mesh></geometry>
        <material><ambient>0.2 0.2 0.2 1</ambient><diffuse>0.2 0.2 0.2 1</diffuse></material>
      </visual>
      <visual name="top_plate">
        <geometry><mesh><uri>model://husky/meshes/top_plate.stl</uri></mesh></geometry>
        <material><ambient>0.9 0.8 0.1 1</ambient><diffuse>0.9 0.8 0.1 1</diffuse></material>
      </visual>
    </link>

    <link name="front_left_wheel">
      <pose>0.26 0.285 0.09 0 0 0</pose>
      <inertial>
        <mass>2.637</mass>
        <inertia>
          <ixx>0.02467</ixx> <ixy>0</ixy> <ixz>0</ixz>
          <iyy>0.04411</iyy> <iyz>0</iyz> <izz>0.02467</izz>
        </inertia>
      </inertial>
      <collision name="collision">
        <pose>0 0 0 1.5708 0 0</pose>
        <geometry>
          <cylinder><radius>0.177</radius><length>0.114</length></cylinder>
        </geometry>
        <surface>
          <friction>
            <ode><mu>1.0</mu><mu2>1.0</mu2></ode>
          </friction>
        </surface>
      </collision>
      <visual name="visual">
        <geometry><mesh><uri>model://husky/meshes/wheel.stl</uri></mesh></geometry>
        <material><ambient>0.1 0.1 0.1 1</ambient><diffuse>0.1 0.1 0.1 1</diffuse></material>
      </visual>
    </link>

    <joint name="front_left_joint" type="revolute">
      <parent>base_link</parent>
      <child>front_left_wheel</child>
      <axis>
        <xyz>0 1 0</xyz>
        <limit><lower>-1e16</lower><upper>1e16</upper></limit>
      </axis>
    </joint>

    <link name="front_right_wheel">
      <pose>0.26 -0.285 0.09 0 0 0</pose>
      <inertial>
        <mass>2.637</mass>
        <inertia>
          <ixx>0.02467</ixx> <ixy>0</ixy> <ixz>0</ixz>
          <iyy>0.04411</iyy> <iyz>0</iyz> <izz>0.02467</izz>
        </inertia>
      </inertial>
      <collision name="collision">
        <pose>0 0 0 1.5708 0 0</pose>
        <geometry>
          <cylinder><radius>0.177</radius><length>0.114</length></cylinder>
        </geometry>
        <surface>
          <friction>
            <ode><mu>1.0</mu><mu2>1.0</mu2></ode>
          </friction>
        </surface>
      </collision>
      <visual name="visual">
        <geometry><mesh><uri>model://husky/meshes/wheel.stl</uri></mesh></geometry>
        <material><ambient>0.1 0.1 0.1 1</ambient><diffuse>0.1 0.1 0.1 1</diffuse></material>
      </visual>
    </link>

    <joint name="front_right_joint" type="revolute">
      <parent>base_link</parent>
      <child>front_right_wheel</child>
      <axis>
        <xyz>0 1 0</xyz>
        <limit><lower>-1e16</lower><upper>1e16</upper></limit>
      </axis>
    </joint>

    <link name="back_left_wheel">
      <pose>-0.26 0.285 0.09 0 0 0</pose>
      <inertial>
        <mass>2.637</mass>
        <inertia>
          <ixx>0.02467</ixx> <ixy>0</ixy> <ixz>0</ixz>
          <iyy>0.04411</iyy> <iyz>0</iyz> <izz>0.02467</izz>
        </inertia>
      </inertial>
      <collision name="collision">
        <pose>0 0 0 1.5708 0 0</pose>
        <geometry>
          <cylinder><radius>0.177</radius><length>0.114</length></cylinder>
        </geometry>
        <surface>
          <friction>
            <ode><mu>1.0</mu><mu2>1.0</mu2></ode>
          </friction>
        </surface>
      </collision>
      <visual name="visual">
        <geometry><mesh><uri>model://husky/meshes/wheel.stl</uri></mesh></geometry>
        <material><ambient>0.1 0.1 0.1 1</ambient><diffuse>0.1 0.1 0.1 1</diffuse></material>
      </visual>
    </link>

    <joint name="back_left_joint" type="revolute">
      <parent>base_link</parent>
      <child>back_left_wheel</child>
      <axis>
        <xyz>0 1 0</xyz>
        <limit><lower>-1e16</lower><upper>1e16</upper></limit>
      </axis>
    </joint>

    <link name="back_right_wheel">
      <pose>-0.26 -0.285 0.09 0 0 0</pose>
      <inertial>
        <mass>2.637</mass>
        <inertia>
          <ixx>0.02467</ixx> <ixy>0</ixy> <ixz>0</ixz>
          <iyy>0.04411</iyy> <iyz>0</iyz> <izz>0.02467</izz>
        </inertia>
      </inertial>
      <collision name="collision">
        <pose>0 0 0 1.5708 0 0</pose>
        <geometry>
          <cylinder><radius>0.177</radius><length>0.114</length></cylinder>
        </geometry>
        <surface>
          <friction>
            <ode><mu>1.0</mu><mu2>1.0</mu2></ode>
          </friction>
        </surface>
      </collision>
      <visual name="visual">
        <geometry><mesh><uri>model://husky/meshes/wheel.stl</uri></mesh></geometry>
        <material><ambient>0.1 0.1 0.1 1</ambient><diffuse>0.1 0.1 0.1 1</diffuse></material>
      </visual>
    </link>

    <joint name="back_right_joint" type="revolute">
      <parent>base_link</parent>
      <child>back_right_wheel</child>
      <axis>
        <xyz>0 1 0</xyz>
        <limit><lower>-1e16</lower><upper>1e16</upper></limit>
      </axis>
    </joint>

    <plugin
      filename="libignition-gazebo-diff-drive-system.so"
      name="gz::sim::systems::DiffDrive">
      <left_joint>front_left_joint</left_joint>
      <left_joint>back_left_joint</left_joint>
      <right_joint>front_right_joint</right_joint>
      <right_joint>back_right_joint</right_joint>
      <wheel_separation>0.57</wheel_separation>
      <wheel_radius>0.177</wheel_radius>
      <topic>/cmd_vel</topic>
      <odom_topic>/odom</odom_topic>
      <base_frame>base_link</base_frame>
      <odom_frame>odom</odom_frame>
      <min_acceleration>-5.0</min_acceleration>
      <max_acceleration>5.0</max_acceleration>
    </plugin>

  </model>
</sdf>